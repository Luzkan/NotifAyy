{% extends 'base.html' %}

{% block head %}
    <title>Home</title>
{% endblock %}
    <br>
{% block body %}


    <!-- User is logged in -->
    {% if emailuser %}

        <!-- Title -->
        <main role="main">
            <div>
                <div class="col-sm-8 mx-auto">
                    <br>
                    <header id="header">
                        <h2>Hello, {{ emailuser }}!</h2>
                        <p class="text-nowrap bd-highlight">No worries, NotifAyy will check stuff for you!</p> 
                    </header>                                        
                </div>
            </div>
        </main>

        <!-- New Alerts (at the very top) -->
        <h2 class="mx-auto">Create New Alert:</h2>
        <form action='/alerts' method='POST'>
            <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="">Webpage URL</span>
                </div>
                <input class="form-control" type="text" name='page' id='page' placeholder="youtube.com/youtuber/videos" aria-label="Enter Page">
            </div>
            <br>
            <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="">Alert Title</span>
                </div>
                <input class="form-control" type="text" name='title' id='title' placeholder="My Fav Youtuber" aria-label="Enter Title">
            </div>
            <br>
            
            <!-- App Buttons Booleans -->
            <div class="btn-group" role="group" aria-label="Basic example">
                <button type="button" class="btn btn-outline-dark" name='messenger' id='messenger' data-toggle="button" aria-pressed="false" autocomplete="off">
                    Messenger
                </button>
                <button type="button" class="btn btn-outline-dark fas fa-cog" data-toggle="collapse" aria-pressed="false" data-target="#collapseMessenger"></button>
            </div>

            <div class="btn-group" role="group" aria-label="Basic example">
                <button type="button" class="btn btn-outline-dark" name='discord' id='discord' data-toggle="button" aria-pressed="false" autocomplete="off">
                    Discord
                </button>
                <button type="button" class="btn btn-outline-dark fas fa-cog" data-toggle="collapse" aria-pressed="false" data-target="#collapseDiscord"></button>
            </div>

            <div class="btn-group" role="group" aria-label="Basic example">
                <button type="button" class="btn btn-outline-dark" name='telegram' id='telegram' data-toggle="button" aria-pressed="false" autocomplete="off">
                    Telegram
                </button>
                <button type="button" class="btn btn-outline-dark fas fa-cog" data-toggle="collapse" aria-pressed="false" data-target="#collapseTelegram"></button>
            </div>

            <input class="btn btn-outline-primary" href='/alerts' style="float: right;" type='submit' value='Add New Alert'>

            <!-- TODO: Logged User value handling -->
            <input class="form-control" type="text" name='currentuser' id='currentuser' value="{{ emailuser }}" style="visibility: hidden; height: 0px;">
            <br>
        </form>

        <!-- These are the additional divs that appears after pressing wheel right to the messenging app button -->
        <div class="collapse" id="collapseMessenger">
            <div class="container-fluid">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="basic-addon1">Your Facebook Page:</span>
                    </div>
                    <input type="text" class="form-control" placeholder="facebook.com/notiff.ayy" aria-label="Username" style="margin-right: 10px;" aria-describedby="basic-addon1">
                    <button type="button" id="connect_button_m" class="btn btn-outline-success">Connect</button>
                </div>
            </div>
        </div>

        <div class="collapse" id="collapseDiscord">
            <div class="container-fluid">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="basic-addon1">Your Discord Name:</span>
                    </div>
                    <input type="text" class="form-control" placeholder="Notifayy#2934" aria-label="Username" style="margin-right: 10px;" aria-describedby="basic-addon1">
                    <button type="button" id="connect_button_d" class="btn btn-outline-success">Connect</button>
                </div>
            </div>
        </div>

        <div class="collapse" id="collapseTelegram">
            <div class="container-fluid">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="basic-addon1">Your Telegram Name:</span>
                    </div>
                    <input type="text" class="form-control" placeholder="Notifayy#1337" aria-label="Username" style="margin-right: 10px;" aria-describedby="basic-addon1">
                    <button type="button" id="connect_button_t" class="btn btn-outline-success">Connect</button>
                </div>
            </div>
        </div>

        <!-- All Alerts -->
        <hr>
        {% for alert in alerts %}
            <div class="container-fluid">
                <h3>{{ alert.title }}
                <a class="btn btn-outline-danger" href='/alerts/delete/{{alert.id}}' style="width: 80px; float: right; margin-right: 0px;">Delete</a> 
                <a class="btn btn-outline-primary" href='/alerts/edit/{{alert.id}}' style="width: 80px; float: right; margin-right: 5px;">Edit</a>

                <!-- Here are the icons for devices where the app will ping if change was found -->
                <a class="btn btn-outline-dark fab fa-telegram" aria-pressed="false" style="float: right; margin-right: 15px;" disabled="true"></a>
                <a class="btn btn-outline-dark fab fa-discord" aria-pressed="false" style="float: right; margin-right: 5px;" disabled="true"></a>
                <a class="btn btn-outline-dark fas fa-comment" aria-pressed="false" style="float: right; margin-right: 5px;" disabled="true"></a>
                </h3>
            </div>
            <div class="container-fluid" style="font-size: 0.65em; margin-top: 10px; ">
                <p>Site: {{ alert.page }} <small style="float: right;"> Added on: {{ alert.date_added }}</small> </p>
            </div>

            <hr>
            <br>
        {% endfor %}

    <!-- User is not logged in (is on landing page) -->
    {% else %}
        <header id="header">
            <h1>NotifAyy</h1>
            <p >Get informed when someone post an update anywhere, everywhere.</p> 
        </header>

        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class="notification is-danger">
                    <i>{{ messages[0] }}</i>
                </div>
            {% endif %}
        {% endwith %}
            
        <form id="signup-form" method="POST" action="/login">
            <input type="email" name="email" id="email" placeholder="Email Address" />
            <input type="password" name="password" id="password" placeholder="Password" />

            <div class="container">
                <div class="row">
                    <input class="btn btn-outline-primary" formaction="/login" href='/login' type="submit" value="Login" style="margin-right: 10px;" />
                    <input class="btn btn-outline-primary" formaction="/register" href='/register' type="submit" value="Sign Up" />
                    <input type="checkbox" class="form-check-input" id="remember">
                    <label class="form-check-label text-nowrap" style="font-size: 20px; margin-top: 5px;" for="remember">Remember me</label>
                </div>
            </div>
        </form>
    {% endif %}
{% endblock %}